; Java Library
;
; Copyright (C) 2019 Kestrel Institute (http://www.kestrel.edu)
;
; License: A 3-clause BSD license. See the LICENSE file distributed with ACL2.
;
; Author: Alessandro Coglio (coglio@kestrel.edu)

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(in-package "ACL2")

(include-book "../implementation" :ttags (:open-input-channel (:oslib) (:quicklisp) :quicklisp.osicat))

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

; This file contains tests for the generation of Java code
; that manipulates Java primitive values.

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

; As explained in the ATJ user documentation,
; the tests passed to :TESTS may only involve
; the target functions explicitly passed to ATJ,
; which may not include the functions in *ATJ-PRIMITIVE-FNS*
; when :DEEP is NIL and :GUARDS is T.
; Thus, here we introduce wrappers for such functions,
; which are the ones that we want to test here.

(defun test-boolean-not (x)
  (declare (xargs :guard (java::boolean-value-p x)))
  (java::boolean-not x))

(defun test-boolean-and (x y)
  (declare (xargs :guard (and (java::boolean-value-p x)
                              (java::boolean-value-p y))))
  (java::boolean-and x y))

(defun test-boolean-xor (x y)
  (declare (xargs :guard (and (java::boolean-value-p x)
                              (java::boolean-value-p y))))
  (java::boolean-xor x y))

(defun test-boolean-ior (x y)
  (declare (xargs :guard (and (java::boolean-value-p x)
                              (java::boolean-value-p y))))
  (java::boolean-ior x y))

(defun test-boolean-eq (x y)
  (declare (xargs :guard (and (java::boolean-value-p x)
                              (java::boolean-value-p y))))
  (java::boolean-eq x y))

(defun test-boolean-neq (x y)
  (declare (xargs :guard (and (java::boolean-value-p x)
                              (java::boolean-value-p y))))
  (java::boolean-neq x y))

(defun test-int-plus (x)
  (declare (xargs :guard (java::int-value-p x)))
  (java::int-plus x))

(defun test-long-plus (x)
  (declare (xargs :guard (java::long-value-p x)))
  (java::long-plus x))

(defun test-int-minus (x)
  (declare (xargs :guard (java::int-value-p x)))
  (java::int-minus x))

(defun test-long-minus (x)
  (declare (xargs :guard (java::long-value-p x)))
  (java::long-minus x))

(defun test-int-not (x)
  (declare (xargs :guard (java::int-value-p x)))
  (java::int-not x))

(defun test-long-not (x)
  (declare (xargs :guard (java::long-value-p x)))
  (java::long-not x))

(defun test-int-add (x y)
  (declare (xargs :guard (and (java::int-value-p x)
                              (java::int-value-p y))))
  (java::int-add x y))

(defun test-long-add (x y)
  (declare (xargs :guard (and (java::long-value-p x)
                              (java::long-value-p y))))
  (java::long-add x y))

(defun test-int-sub (x y)
  (declare (xargs :guard (and (java::int-value-p x)
                              (java::int-value-p y))))
  (java::int-sub x y))

(defun test-long-sub (x y)
  (declare (xargs :guard (and (java::long-value-p x)
                              (java::long-value-p y))))
  (java::long-sub x y))

(defun test-int-mul (x y)
  (declare (xargs :guard (and (java::int-value-p x)
                              (java::int-value-p y))))
  (java::int-mul x y))

(defun test-long-mul (x y)
  (declare (xargs :guard (and (java::long-value-p x)
                              (java::long-value-p y))))
  (java::long-mul x y))

(defun test-int-div (x y)
  (declare (xargs :guard (and (java::int-value-p x)
                              (java::int-value-p y)
                              (not (equal (java::int-value->int y) 0)))))
  (java::int-div x y))

(defun test-long-div (x y)
  (declare (xargs :guard (and (java::long-value-p x)
                              (java::long-value-p y)
                              (not (equal (java::long-value->int y) 0)))))
  (java::long-div x y))

(defun test-int-rem (x y)
  (declare (xargs :guard (and (java::int-value-p x)
                              (java::int-value-p y)
                              (not (equal (java::int-value->int y) 0)))))
  (java::int-rem x y))

(defun test-long-rem (x y)
  (declare (xargs :guard (and (java::long-value-p x)
                              (java::long-value-p y)
                              (not (equal (java::long-value->int y) 0)))))
  (java::long-rem x y))

(defun test-int-and (x y)
  (declare (xargs :guard (and (java::int-value-p x)
                              (java::int-value-p y))))
  (java::int-and x y))

(defun test-long-and (x y)
  (declare (xargs :guard (and (java::long-value-p x)
                              (java::long-value-p y))))
  (java::long-and x y))

(defun test-int-xor (x y)
  (declare (xargs :guard (and (java::int-value-p x)
                              (java::int-value-p y))))
  (java::int-xor x y))

(defun test-long-xor (x y)
  (declare (xargs :guard (and (java::long-value-p x)
                              (java::long-value-p y))))
  (java::long-xor x y))

(defun test-int-ior (x y)
  (declare (xargs :guard (and (java::int-value-p x)
                              (java::int-value-p y))))
  (java::int-ior x y))

(defun test-long-ior (x y)
  (declare (xargs :guard (and (java::long-value-p x)
                              (java::long-value-p y))))
  (java::long-ior x y))

(defun test-int-eq (x y)
  (declare (xargs :guard (and (java::int-value-p x)
                              (java::int-value-p y))))
  (java::int-eq x y))

(defun test-long-eq (x y)
  (declare (xargs :guard (and (java::long-value-p x)
                              (java::long-value-p y))))
  (java::long-eq x y))

(defun test-int-neq (x y)
  (declare (xargs :guard (and (java::int-value-p x)
                              (java::int-value-p y))))
  (java::int-neq x y))

(defun test-long-neq (x y)
  (declare (xargs :guard (and (java::long-value-p x)
                              (java::long-value-p y))))
  (java::long-neq x y))

(defun test-int-less (x y)
  (declare (xargs :guard (and (java::int-value-p x)
                              (java::int-value-p y))))
  (java::int-less x y))

(defun test-long-less (x y)
  (declare (xargs :guard (and (java::long-value-p x)
                              (java::long-value-p y))))
  (java::long-less x y))

(defun test-int-lesseq (x y)
  (declare (xargs :guard (and (java::int-value-p x)
                              (java::int-value-p y))))
  (java::int-lesseq x y))

(defun test-long-lesseq (x y)
  (declare (xargs :guard (and (java::long-value-p x)
                              (java::long-value-p y))))
  (java::long-lesseq x y))

(defun test-int-great (x y)
  (declare (xargs :guard (and (java::int-value-p x)
                              (java::int-value-p y))))
  (java::int-great x y))

(defun test-long-great (x y)
  (declare (xargs :guard (and (java::long-value-p x)
                              (java::long-value-p y))))
  (java::long-great x y))

(defun test-int-greateq (x y)
  (declare (xargs :guard (and (java::int-value-p x)
                              (java::int-value-p y))))
  (java::int-greateq x y))

(defun test-long-greateq (x y)
  (declare (xargs :guard (and (java::long-value-p x)
                              (java::long-value-p y))))
  (java::long-greateq x y))

(defun test-int-int-shiftl (x y)
  (declare (xargs :guard (and (java::int-value-p x)
                              (java::int-value-p y))))
  (java::int-int-shiftl x y))

(defun test-long-long-shiftl (x y)
  (declare (xargs :guard (and (java::long-value-p x)
                              (java::long-value-p y))))
  (java::long-long-shiftl x y))

(defun test-long-int-shiftl (x y)
  (declare (xargs :guard (and (java::long-value-p x)
                              (java::int-value-p y))))
  (java::long-int-shiftl x y))

(defun test-int-long-shiftl (x y)
  (declare (xargs :guard (and (java::int-value-p x)
                              (java::long-value-p y))))
  (java::int-long-shiftl x y))

(defun test-int-int-shiftr (x y)
  (declare (xargs :guard (and (java::int-value-p x)
                              (java::int-value-p y))))
  (java::int-int-shiftr x y))

(defun test-long-long-shiftr (x y)
  (declare (xargs :guard (and (java::long-value-p x)
                              (java::long-value-p y))))
  (java::long-long-shiftr x y))

(defun test-long-int-shiftr (x y)
  (declare (xargs :guard (and (java::long-value-p x)
                              (java::int-value-p y))))
  (java::long-int-shiftr x y))

(defun test-int-long-shiftr (x y)
  (declare (xargs :guard (and (java::int-value-p x)
                              (java::long-value-p y))))
  (java::int-long-shiftr x y))

(defun test-int-int-ushiftr (x y)
  (declare (xargs :guard (and (java::int-value-p x)
                              (java::int-value-p y))))
  (java::int-int-ushiftr x y))

(defun test-long-long-ushiftr (x y)
  (declare (xargs :guard (and (java::long-value-p x)
                              (java::long-value-p y))))
  (java::long-long-ushiftr x y))

(defun test-long-int-ushiftr (x y)
  (declare (xargs :guard (and (java::long-value-p x)
                              (java::int-value-p y))))
  (java::long-int-ushiftr x y))

(defun test-int-long-ushiftr (x y)
  (declare (xargs :guard (and (java::int-value-p x)
                              (java::long-value-p y))))
  (java::int-long-ushiftr x y))

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

; More functions over (ACL2 representations of) Java primitive values.

(defun f-boolean (x y)
  (declare (xargs :guard (and (java::boolean-value-p x)
                              (java::boolean-value-p y))))
  (java::boolean-and (java::boolean-xor x y)
                     (java::boolean-ior x y)))

(defun g-boolean (x y z)
  (declare (xargs :guard (and (java::boolean-value-p x)
                              (java::boolean-value-p y)
                              (java::boolean-value-p z))))
  (java::boolean-eq (java::boolean-not x)
                    (java::boolean-neq y z)))

(defun f-int (x y)
  (declare (xargs :guard (and (java::int-value-p x)
                              (java::int-value-p y))))
  (java::int-add (java::int-mul (java::int-value 2) x)
                 (java::int-mul y y)))

(defun g-int (x y z)
  (declare (xargs :guard (and (java::int-value-p x)
                              (java::int-value-p y)
                              (java::int-value-p z))))
  (java::int-int-shiftl (java::int-sub x
                                       (java::int-and y z))
                        (java::int-not z)))

(defun h-int (x)
  (declare (xargs :guard (and (java::int-value-p x))))
  (java::int-xor (java::int-div x (java::int-value 119))
                 (java::int-rem x (java::int-value -373))))

(defun f-long (x y)
  (declare (xargs :guard (and (java::long-value-p x)
                              (java::long-value-p y))))
  (java::long-add (java::long-mul (java::long-value 2) x)
                  (java::long-mul y y)))

(defun g-long (x y z)
  (declare (xargs :guard (and (java::long-value-p x)
                              (java::long-value-p y)
                              (java::long-value-p z))))
  (java::long-long-shiftl (java::long-sub x
                                          (java::long-and y z))
                          (java::long-not z)))

(defun h-long (x)
  (declare (xargs :guard (and (java::long-value-p x))))
  (java::long-xor (java::long-div x (java::long-value 119))
                  (java::long-rem x (java::long-value -373))))

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

; Tests for the functions above, when :DEEP is NIL and :GUARDS is T.

(defconst *shallow-guarded-basic-tests*
  '(;; boolean negation:
    ("BooleanNotT" (test-boolean-not (java::boolean-value t)))
    ("BooleanNotF" (test-boolean-not (java::boolean-value nil)))
    ;; boolean conjunction:
    ("BooleanAndTT" (test-boolean-and (java::boolean-value t)
                                      (java::boolean-value t)))
    ("BooleanAndTF" (test-boolean-and (java::boolean-value t)
                                      (java::boolean-value nil)))
    ("BooleanAndFT" (test-boolean-and (java::boolean-value nil)
                                      (java::boolean-value t)))
    ("BooleanAndFF" (test-boolean-and (java::boolean-value nil)
                                      (java::boolean-value nil)))
    ;; boolean exclusive disjunction:
    ("BooleanXorTT" (test-boolean-xor (java::boolean-value t)
                                      (java::boolean-value t)))
    ("BooleanXorTF" (test-boolean-xor (java::boolean-value t)
                                      (java::boolean-value nil)))
    ("BooleanXorFT" (test-boolean-xor (java::boolean-value nil)
                                      (java::boolean-value t)))
    ("BooleanXorFF" (test-boolean-xor (java::boolean-value nil)
                                      (java::boolean-value nil)))
    ;; boolean inclusive disjunction:
    ("BooleanIorTT" (test-boolean-ior (java::boolean-value t)
                                      (java::boolean-value t)))
    ("BooleanIorTF" (test-boolean-ior (java::boolean-value t)
                                      (java::boolean-value nil)))
    ("BooleanIorFT" (test-boolean-ior (java::boolean-value nil)
                                      (java::boolean-value t)))
    ("BooleanIorFF" (test-boolean-ior (java::boolean-value nil)
                                      (java::boolean-value nil)))
    ;; boolean equality:
    ("BooleanEqTT" (test-boolean-eq (java::boolean-value t)
                                    (java::boolean-value t)))
    ("BooleanEqTF" (test-boolean-eq (java::boolean-value t)
                                    (java::boolean-value nil)))
    ("BooleanEqFT" (test-boolean-eq (java::boolean-value nil)
                                    (java::boolean-value t)))
    ("BooleanEqFF" (test-boolean-eq (java::boolean-value nil)
                                    (java::boolean-value nil)))
    ;; boolean non-equality:
    ("BooleanNeqTT" (test-boolean-neq (java::boolean-value t)
                                      (java::boolean-value t)))
    ("BooleanNeqTF" (test-boolean-neq (java::boolean-value t)
                                      (java::boolean-value nil)))
    ("BooleanNeqFT" (test-boolean-neq (java::boolean-value nil)
                                      (java::boolean-value t)))
    ("BooleanNeqFF" (test-boolean-neq (java::boolean-value nil)
                                      (java::boolean-value nil)))
    ;; int unary plus:
    ("IntPlus0" (test-int-plus (java::int-value 0)))
    ("IntPlus1" (test-int-plus (java::int-value 1)))
    ("IntPlus2" (test-int-plus (java::int-value 875753)))
    ("IntPlus3" (test-int-plus (java::int-value -16)))
    ("IntPlus4" (test-int-plus (java::int-value -1600000)))
    ;; long unary plus:
    ("LongPlus0" (test-long-plus (java::long-value 0)))
    ("LongPlus1" (test-long-plus (java::long-value 1)))
    ("LongPlus2" (test-long-plus (java::long-value 875753)))
    ("LongPlus3" (test-long-plus (java::long-value -16)))
    ("LongPlus4" (test-long-plus (java::long-value -1600000)))
    ;; int unary minus:
    ("IntMinus0" (test-int-minus (java::int-value 0)))
    ("IntMinus1" (test-int-minus (java::int-value 1)))
    ("IntMinus2" (test-int-minus (java::int-value 875753)))
    ("IntMinus3" (test-int-minus (java::int-value -16)))
    ("IntMinus4" (test-int-minus (java::int-value -1600000)))
    ;; long unary minus:
    ("LongMinus0" (test-long-minus (java::long-value 0)))
    ("LongMinus1" (test-long-minus (java::long-value 1)))
    ("LongMinus2" (test-long-minus (java::long-value 875753)))
    ("LongMinus3" (test-long-minus (java::long-value -16)))
    ("LongMinus4" (test-long-minus (java::long-value -1600000)))
    ;; int bitwise complement:
    ("IntNot0" (test-int-not (java::int-value 0)))
    ("IntNot1" (test-int-not (java::int-value 1)))
    ("IntNot2" (test-int-not (java::int-value 875753)))
    ("IntNot3" (test-int-not (java::int-value -16)))
    ("IntNot4" (test-int-not (java::int-value -1600000)))
    ;; long bitwise complement:
    ("LongNot0" (test-long-not (java::long-value 0)))
    ("LongNot1" (test-long-not (java::long-value 1)))
    ("LongNot2" (test-long-not (java::long-value 875753)))
    ("LongNot3" (test-long-not (java::long-value -16)))
    ("LongNot4" (test-long-not (java::long-value -1600000)))
    ;; int addition:
    ("IntAdd0" (test-int-add (java::int-value 2)
                             (java::int-value 3)))
    ("IntAdd1" (test-int-add (java::int-value -2)
                             (java::int-value -3)))
    ("IntAdd2" (test-int-add (java::int-value 2)
                             (java::int-value -3)))
    ("IntAdd3" (test-int-add (java::int-value -2)
                             (java::int-value 3)))
    ("IntAdd4" (test-int-add (java::int-value 2372792)
                             (java::int-value -8882289)))
    ;; long addition:
    ("LongAdd0" (test-long-add (java::long-value 2)
                               (java::long-value 3)))
    ("LongAdd1" (test-long-add (java::long-value -2)
                               (java::long-value -3)))
    ("LongAdd2" (test-long-add (java::long-value 2)
                               (java::long-value -3)))
    ("LongAdd3" (test-long-add (java::long-value -2)
                               (java::long-value 3)))
    ("LongAdd4" (test-long-add (java::long-value 2372792)
                               (java::long-value -8882289)))
    ;; int subtraction:
    ("IntSub0" (test-int-sub (java::int-value 2)
                             (java::int-value 3)))
    ("IntSub1" (test-int-sub (java::int-value -2)
                             (java::int-value -3)))
    ("IntSub2" (test-int-sub (java::int-value 2)
                             (java::int-value -3)))
    ("IntSub3" (test-int-sub (java::int-value -2)
                             (java::int-value 3)))
    ("IntSub4" (test-int-sub (java::int-value 2372792)
                             (java::int-value -8882289)))
    ;; long subtraction:
    ("LongSub0" (test-long-sub (java::long-value 2)
                               (java::long-value 3)))
    ("LongSub1" (test-long-sub (java::long-value -2)
                               (java::long-value -3)))
    ("LongSub2" (test-long-sub (java::long-value 2)
                               (java::long-value -3)))
    ("LongSub3" (test-long-sub (java::long-value -2)
                               (java::long-value 3)))
    ("LongSub4" (test-long-sub (java::long-value 2372792)
                               (java::long-value -8882289)))
    ;; int multiplication:
    ("IntMul0" (test-int-mul (java::int-value 2)
                             (java::int-value 3)))
    ("IntMul1" (test-int-mul (java::int-value -2)
                             (java::int-value -3)))
    ("IntMul2" (test-int-mul (java::int-value 2)
                             (java::int-value -3)))
    ("IntMul3" (test-int-mul (java::int-value -2)
                             (java::int-value 3)))
    ("IntMul4" (test-int-mul (java::int-value 2372792)
                             (java::int-value -8882289)))
    ;; long multiplication:
    ("LongMul0" (test-long-mul (java::long-value 2)
                               (java::long-value 3)))
    ("LongMul1" (test-long-mul (java::long-value -2)
                               (java::long-value -3)))
    ("LongMul2" (test-long-mul (java::long-value 2)
                               (java::long-value -3)))
    ("LongMul3" (test-long-mul (java::long-value -2)
                               (java::long-value 3)))
    ("LongMul4" (test-long-mul (java::long-value 2372792)
                               (java::long-value -8882289)))
    ;; int division:
    ("IntDiv0" (test-int-div (java::int-value 2)
                             (java::int-value 3)))
    ("IntDiv1" (test-int-div (java::int-value -2)
                             (java::int-value -3)))
    ("IntDiv2" (test-int-div (java::int-value 2)
                             (java::int-value -3)))
    ("IntDiv3" (test-int-div (java::int-value -2)
                             (java::int-value 3)))
    ("IntDiv4" (test-int-div (java::int-value 2372792)
                             (java::int-value -8882289)))
    ;; long division:
    ("LongDiv0" (test-long-div (java::long-value 2)
                               (java::long-value 3)))
    ("LongDiv1" (test-long-div (java::long-value -2)
                               (java::long-value -3)))
    ("LongDiv2" (test-long-div (java::long-value 2)
                               (java::long-value -3)))
    ("LongDiv3" (test-long-div (java::long-value -2)
                               (java::long-value 3)))
    ("LongDiv4" (test-long-div (java::long-value 2372792)
                               (java::long-value -8882289)))
    ;; int remainder:
    ("IntRem0" (test-int-rem (java::int-value 2)
                             (java::int-value 3)))
    ("IntRem1" (test-int-rem (java::int-value -2)
                             (java::int-value -3)))
    ("IntRem2" (test-int-rem (java::int-value 2)
                             (java::int-value -3)))
    ("IntRem3" (test-int-rem (java::int-value -2)
                             (java::int-value 3)))
    ("IntRem4" (test-int-rem (java::int-value 2372792)
                             (java::int-value -8882289)))
    ;; long remainder:
    ("LongRem0" (test-long-rem (java::long-value 2)
                               (java::long-value 3)))
    ("LongRem1" (test-long-rem (java::long-value -2)
                               (java::long-value -3)))
    ("LongRem2" (test-long-rem (java::long-value 2)
                               (java::long-value -3)))
    ("LongRem3" (test-long-rem (java::long-value -2)
                               (java::long-value 3)))
    ("LongRem4" (test-long-rem (java::long-value 2372792)
                               (java::long-value -8882289)))
    ;; int bitwise conjunction:
    ("IntAnd0" (test-int-and (java::int-value 2)
                             (java::int-value 3)))
    ("IntAnd1" (test-int-and (java::int-value -2)
                             (java::int-value -3)))
    ("IntAnd2" (test-int-and (java::int-value 2)
                             (java::int-value -3)))
    ("IntAnd3" (test-int-and (java::int-value -2)
                             (java::int-value 3)))
    ("IntAnd4" (test-int-and (java::int-value 2372792)
                             (java::int-value -8882289)))
    ;; long bitwise conjunction:
    ("LongAnd0" (test-long-and (java::long-value 2)
                               (java::long-value 3)))
    ("LongAnd1" (test-long-and (java::long-value -2)
                               (java::long-value -3)))
    ("LongAnd2" (test-long-and (java::long-value 2)
                               (java::long-value -3)))
    ("LongAnd3" (test-long-and (java::long-value -2)
                               (java::long-value 3)))
    ("LongAnd4" (test-long-and (java::long-value 2372792)
                               (java::long-value -8882289)))
    ;; int bitwise exclusive disjunction:
    ("IntXor0" (test-int-xor (java::int-value 2)
                             (java::int-value 3)))
    ("IntXor1" (test-int-xor (java::int-value -2)
                             (java::int-value -3)))
    ("IntXor2" (test-int-xor (java::int-value 2)
                             (java::int-value -3)))
    ("IntXor3" (test-int-xor (java::int-value -2)
                             (java::int-value 3)))
    ("IntXor4" (test-int-xor (java::int-value 2372792)
                             (java::int-value -8882289)))
    ;; long bitwise exclusive disjunction:
    ("LongXor0" (test-long-xor (java::long-value 2)
                               (java::long-value 3)))
    ("LongXor1" (test-long-xor (java::long-value -2)
                               (java::long-value -3)))
    ("LongXor2" (test-long-xor (java::long-value 2)
                               (java::long-value -3)))
    ("LongXor3" (test-long-xor (java::long-value -2)
                               (java::long-value 3)))
    ("LongXor4" (test-long-xor (java::long-value 2372792)
                               (java::long-value -8882289)))
    ;; int bitwise inclusive disjunction:
    ("IntIor0" (test-int-ior (java::int-value 2)
                             (java::int-value 3)))
    ("IntIor1" (test-int-ior (java::int-value -2)
                             (java::int-value -3)))
    ("IntIor2" (test-int-ior (java::int-value 2)
                             (java::int-value -3)))
    ("IntIor3" (test-int-ior (java::int-value -2)
                             (java::int-value 3)))
    ("IntIor4" (test-int-ior (java::int-value 2372792)
                             (java::int-value -8882289)))
    ;; long bitwise inclusive disjunction:
    ("LongIor0" (test-long-ior (java::long-value 2)
                               (java::long-value 3)))
    ("LongIor1" (test-long-ior (java::long-value -2)
                               (java::long-value -3)))
    ("LongIor2" (test-long-ior (java::long-value 2)
                               (java::long-value -3)))
    ("LongIor3" (test-long-ior (java::long-value -2)
                               (java::long-value 3)))
    ("LongIor4" (test-long-ior (java::long-value 2372792)
                               (java::long-value -8882289)))
    ;; int equality:
    ("IntEq0" (test-int-eq (java::int-value 2829)
                           (java::int-value 2829)))
    ("IntEq1" (test-int-eq (java::int-value -373)
                           (java::int-value 0)))
    ("IntEq2" (test-int-eq (java::int-value 20)
                           (java::int-value 10)))
    ;; long equality:
    ("LongEq0" (test-long-eq (java::long-value 2829)
                             (java::long-value 2829)))
    ("LongEq1" (test-long-eq (java::long-value -373)
                             (java::long-value 0)))
    ("LongEq2" (test-long-eq (java::long-value 20)
                             (java::long-value 10)))
    ;; int non-equality:
    ("IntNeq0" (test-int-neq (java::int-value 2829)
                             (java::int-value 2829)))
    ("IntNeq1" (test-int-neq (java::int-value -373)
                             (java::int-value 0)))
    ("IntNeq2" (test-int-neq (java::int-value 20)
                             (java::int-value 10)))
    ;; long non-equality:
    ("LongNeq0" (test-long-neq (java::long-value 2829)
                               (java::long-value 2829)))
    ("LongNeq1" (test-long-neq (java::long-value -373)
                               (java::long-value 0)))
    ("LongNeq2" (test-long-neq (java::long-value 20)
                               (java::long-value 10)))
    ;; int less-than:
    ("IntLess0" (test-int-less (java::int-value 2829)
                               (java::int-value 2829)))
    ("IntLess1" (test-int-less (java::int-value -373)
                               (java::int-value 0)))
    ("IntLess2" (test-int-less (java::int-value 20)
                               (java::int-value 10)))
    ;; long less-than:
    ("LongLess0" (test-long-less (java::long-value 2829)
                                 (java::long-value 2829)))
    ("LongLess1" (test-long-less (java::long-value -373)
                                 (java::long-value 0)))
    ("LongLess2" (test-long-less (java::long-value 20)
                                 (java::long-value 10)))
    ;; int less-than-or-equal-to:
    ("IntLesseq0" (test-int-lesseq (java::int-value 2829)
                                   (java::int-value 2829)))
    ("IntLesseq1" (test-int-lesseq (java::int-value -373)
                                   (java::int-value 0)))
    ("IntLesseq2" (test-int-lesseq (java::int-value 20)
                                   (java::int-value 10)))
    ;; long less-than-or-equal-to:
    ("LongLesseq0" (test-long-lesseq (java::long-value 2829)
                                     (java::long-value 2829)))
    ("LongLesseq1" (test-long-lesseq (java::long-value -373)
                                     (java::long-value 0)))
    ("LongLesseq2" (test-long-lesseq (java::long-value 20)
                                     (java::long-value 10)))
    ;; int greater-than:
    ("IntGreat0" (test-int-great (java::int-value 2829)
                                 (java::int-value 2829)))
    ("IntGreat1" (test-int-great (java::int-value -373)
                                 (java::int-value 0)))
    ("IntGreat2" (test-int-great (java::int-value 20)
                                 (java::int-value 10)))
    ;; long greater-than:
    ("LongGreat0" (test-long-great (java::long-value 2829)
                                   (java::long-value 2829)))
    ("LongGreat1" (test-long-great (java::long-value -373)
                                   (java::long-value 0)))
    ("LongGreat2" (test-long-great (java::long-value 20)
                                   (java::long-value 10)))
    ;; int greater-than-or-equal-to:
    ("IntGreateq0" (test-int-greateq (java::int-value 2829)
                                     (java::int-value 2829)))
    ("IntGreateq1" (test-int-greateq (java::int-value -373)
                                     (java::int-value 0)))
    ("IntGreateq2" (test-int-greateq (java::int-value 20)
                                     (java::int-value 10)))
    ;; long greater-than-or-equal-to:
    ("LongGreateq0" (test-long-greateq (java::long-value 2829)
                                       (java::long-value 2829)))
    ("LongGreateq1" (test-long-greateq (java::long-value -373)
                                       (java::long-value 0)))
    ("LongGreateq2" (test-long-greateq (java::long-value 20)
                                       (java::long-value 10)))
    ;; int left shift by int distance:
    ("IntIntShiftl0" (test-int-int-shiftl (java::int-value 2)
                                          (java::int-value 3)))
    ("IntIntShiftl1" (test-int-int-shiftl (java::int-value -2)
                                          (java::int-value -3)))
    ("IntIntShiftl2" (test-int-int-shiftl (java::int-value 2)
                                          (java::int-value -3)))
    ("IntIntShiftl3" (test-int-int-shiftl (java::int-value -2)
                                          (java::int-value 3)))
    ("IntIntShiftl4" (test-int-int-shiftl (java::int-value 2372792)
                                          (java::int-value -8882289)))
    ;; long left shift by long distance:
    ("LongLongShiftl0" (test-long-long-shiftl (java::long-value 2)
                                              (java::long-value 3)))
    ("LongLongShiftl1" (test-long-long-shiftl (java::long-value -2)
                                              (java::long-value -3)))
    ("LongLongShiftl2" (test-long-long-shiftl (java::long-value 2)
                                              (java::long-value -3)))
    ("LongLongShiftl3" (test-long-long-shiftl (java::long-value -2)
                                              (java::long-value 3)))
    ("LongLongShiftl4" (test-long-long-shiftl (java::long-value 2372792)
                                              (java::long-value -8882289)))
    ;; long left shift by int distance:
    ("LongIntShiftl0" (test-long-int-shiftl (java::long-value 2)
                                            (java::int-value 3)))
    ("LongIntShiftl1" (test-long-int-shiftl (java::long-value -2)
                                            (java::int-value -3)))
    ("LongIntShiftl2" (test-long-int-shiftl (java::long-value 2)
                                            (java::int-value -3)))
    ("LongIntShiftl3" (test-long-int-shiftl (java::long-value -2)
                                            (java::int-value 3)))
    ("LongIntShiftl4" (test-long-int-shiftl (java::long-value 2372792)
                                            (java::int-value -8882289)))
    ;; int left shift by long distance:
    ("IntLongShiftl0" (test-int-long-shiftl (java::int-value 2)
                                            (java::long-value 3)))
    ("IntLongShiftl1" (test-int-long-shiftl (java::int-value -2)
                                            (java::long-value -3)))
    ("IntLongShiftl2" (test-int-long-shiftl (java::int-value 2)
                                            (java::long-value -3)))
    ("IntLongShiftl3" (test-int-long-shiftl (java::int-value -2)
                                            (java::long-value 3)))
    ("IntLongShiftl4" (test-int-long-shiftl (java::int-value 2372792)
                                            (java::long-value -8882289)))
    ;; int right shift by int distance:
    ("IntIntShiftr0" (test-int-int-shiftr (java::int-value 2)
                                          (java::int-value 3)))
    ("IntIntShiftr1" (test-int-int-shiftr (java::int-value -2)
                                          (java::int-value -3)))
    ("IntIntShiftr2" (test-int-int-shiftr (java::int-value 2)
                                          (java::int-value -3)))
    ("IntIntShiftr3" (test-int-int-shiftr (java::int-value -2)
                                          (java::int-value 3)))
    ("IntIntShiftr4" (test-int-int-shiftr (java::int-value 2372792)
                                          (java::int-value -8882289)))
    ;; long right shift by long distance:
    ("LongLongShiftr0" (test-long-long-shiftr (java::long-value 2)
                                              (java::long-value 3)))
    ("LongLongShiftr1" (test-long-long-shiftr (java::long-value -2)
                                              (java::long-value -3)))
    ("LongLongShiftr2" (test-long-long-shiftr (java::long-value 2)
                                              (java::long-value -3)))
    ("LongLongShiftr3" (test-long-long-shiftr (java::long-value -2)
                                              (java::long-value 3)))
    ("LongLongShiftr4" (test-long-long-shiftr (java::long-value 2372792)
                                              (java::long-value -8882289)))
    ;; long right shift by int distance:
    ("LongIntShiftr0" (test-long-int-shiftr (java::long-value 2)
                                            (java::int-value 3)))
    ("LongIntShiftr1" (test-long-int-shiftr (java::long-value -2)
                                            (java::int-value -3)))
    ("LongIntShiftr2" (test-long-int-shiftr (java::long-value 2)
                                            (java::int-value -3)))
    ("LongIntShiftr3" (test-long-int-shiftr (java::long-value -2)
                                            (java::int-value 3)))
    ("LongIntShiftr4" (test-long-int-shiftr (java::long-value 2372792)
                                            (java::int-value -8882289)))
    ;; int right shift by long distance:
    ("IntLongShiftr0" (test-int-long-shiftr (java::int-value 2)
                                            (java::long-value 3)))
    ("IntLongShiftr1" (test-int-long-shiftr (java::int-value -2)
                                            (java::long-value -3)))
    ("IntLongShiftr2" (test-int-long-shiftr (java::int-value 2)
                                            (java::long-value -3)))
    ("IntLongShiftr3" (test-int-long-shiftr (java::int-value -2)
                                            (java::long-value 3)))
    ("IntLongShiftr4" (test-int-long-shiftr (java::int-value 2372792)
                                            (java::long-value -8882289)))
    ;; int unsigned right shift by int distance:
    ("IntIntUshiftr0" (test-int-int-ushiftr (java::int-value 2)
                                            (java::int-value 3)))
    ("IntIntUshiftr1" (test-int-int-ushiftr (java::int-value -2)
                                            (java::int-value -3)))
    ("IntIntUshiftr2" (test-int-int-ushiftr (java::int-value 2)
                                            (java::int-value -3)))
    ("IntIntUshiftr3" (test-int-int-ushiftr (java::int-value -2)
                                            (java::int-value 3)))
    ("IntIntUshiftr4" (test-int-int-ushiftr (java::int-value 2372792)
                                            (java::int-value -8882289)))
    ;; long unsigned right shift by long distance:
    ("LongLongUshiftr0" (test-long-long-ushiftr (java::long-value 2)
                                                (java::long-value 3)))
    ("LongLongUshiftr1" (test-long-long-ushiftr (java::long-value -2)
                                                (java::long-value -3)))
    ("LongLongUshiftr2" (test-long-long-ushiftr (java::long-value 2)
                                                (java::long-value -3)))
    ("LongLongUshiftr3" (test-long-long-ushiftr (java::long-value -2)
                                                (java::long-value 3)))
    ("LongLongUshiftr4" (test-long-long-ushiftr (java::long-value 2372792)
                                                (java::long-value -8882289)))
    ;; long unsigned right shift by int distance:
    ("LongIntUshiftr0" (test-long-int-ushiftr (java::long-value 2)
                                              (java::int-value 3)))
    ("LongIntUshiftr1" (test-long-int-ushiftr (java::long-value -2)
                                              (java::int-value -3)))
    ("LongIntUshiftr2" (test-long-int-ushiftr (java::long-value 2)
                                              (java::int-value -3)))
    ("LongIntUshiftr3" (test-long-int-ushiftr (java::long-value -2)
                                              (java::int-value 3)))
    ("LongIntUshiftr4" (test-long-int-ushiftr (java::long-value 2372792)
                                              (java::int-value -8882289)))
    ;; int unsigned right shift by long distance:
    ("IntLongUshiftr0" (test-int-long-ushiftr (java::int-value 2)
                                              (java::long-value 3)))
    ("IntLongUshiftr1" (test-int-long-ushiftr (java::int-value -2)
                                              (java::long-value -3)))
    ("IntLongUshiftr2" (test-int-long-ushiftr (java::int-value 2)
                                              (java::long-value -3)))
    ("IntLongUshiftr3" (test-int-long-ushiftr (java::int-value -2)
                                              (java::long-value 3)))
    ("IntLongUshiftr4" (test-int-long-ushiftr (java::int-value 2372792)
                                              (java::long-value -8882289)))))

(defconst *shallow-guarded-more-tests*
  '(;; F-BOOLEAN:
    ("FbooleanTT" (f-boolean (java::boolean-value t)
                             (java::boolean-value t)))
    ("FbooleanTF" (f-boolean (java::boolean-value t)
                             (java::boolean-value nil)))
    ("FbooleanFT" (f-boolean (java::boolean-value nil)
                             (java::boolean-value t)))
    ("FbooleanFF" (f-boolean (java::boolean-value nil)
                             (java::boolean-value nil)))
    ;; G-BOOLEAN:
    ("GbooleanTTT" (g-boolean (java::boolean-value t)
                              (java::boolean-value t)
                              (java::boolean-value t)))
    ("GbooleanTTF" (g-boolean (java::boolean-value t)
                              (java::boolean-value t)
                              (java::boolean-value nil)))
    ("GbooleanTFT" (g-boolean (java::boolean-value t)
                              (java::boolean-value nil)
                              (java::boolean-value t)))
    ("GbooleanTFF" (g-boolean (java::boolean-value t)
                              (java::boolean-value nil)
                              (java::boolean-value nil)))
    ("GbooleanFTT" (g-boolean (java::boolean-value nil)
                              (java::boolean-value t)
                              (java::boolean-value t)))
    ("GbooleanFTF" (g-boolean (java::boolean-value nil)
                              (java::boolean-value t)
                              (java::boolean-value nil)))
    ("GbooleanFFT" (g-boolean (java::boolean-value nil)
                              (java::boolean-value nil)
                              (java::boolean-value t)))
    ("GbooleanFFF" (g-boolean (java::boolean-value nil)
                              (java::boolean-value nil)
                              (java::boolean-value nil)))
    ;; F-INT:
    ("Fint0" (f-int (java::int-value 8)
                    (java::int-value 15)))
    ("Fint1" (f-int (java::int-value -280)
                    (java::int-value 3971)))
    ("Fint2" (f-int (java::int-value 1000000)
                    (java::int-value 1000000)))
    ;; G-INT:
    ("Gint0" (g-int (java::int-value 8383)
                    (java::int-value -3)
                    (java::int-value 0)))
    ("Gint1" (g-int (java::int-value -111)
                    (java::int-value 1383)
                    (java::int-value 90000)))
    ;; H-INT:
    ("Hint0" (h-int (java::int-value 64738)))
    ("Hint1" (h-int (java::int-value -64738)))
    ;; F-LONG:
    ("Flong0" (f-long (java::long-value 8)
                      (java::long-value 15)))
    ("Flong1" (f-long (java::long-value -280)
                      (java::long-value 3971)))
    ("Flong2" (f-long (java::long-value 1000000)
                      (java::long-value 1000000)))
    ;; G-LONG:
    ("Glong0" (g-long (java::long-value 8383)
                      (java::long-value -3)
                      (java::long-value 0)))
    ("Glong1" (g-long (java::long-value -111)
                      (java::long-value 1383)
                      (java::long-value 90000)))
    ;; H-LONG:
    ("Hlong0" (h-long (java::long-value 64738)))
    ("Hlong1" (h-long (java::long-value -64738)))))

(defconst *shallow-guarded-tests*
  (append *shallow-guarded-basic-tests*
          *shallow-guarded-more-tests*))
